(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))e(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&e(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function e(s){if(s.ep)return;s.ep=!0;const n=r(s);fetch(s.href,n)}})();class o{constructor(t){this.parent=t}getHTML(t){return`
            <div class="card" style="width: 300px;">
                <img class="card-img-top" src="/pictures/cat${t.id}.jpg" alt="картинка">
                <div class="card-body">
                    <h5 class="card-title">Кошка ${t.id}</h5>
                    <p class="card-text">Подробнее о кошке</p>
                    <button class="btn btn-primary" id="click-card-${t.id}" data-id="${t.id}">Выбери меня!</button>
                </div>
            </div>
        `}addListeners(t,r){document.getElementById(`click-card-${t.id}`).addEventListener("click",r)}render(t,r){const e=this.getHTML(t);this.parent.insertAdjacentHTML("beforeend",e),this.addListeners(t,r)}}class h{constructor(t){this.parent=t}addListeners(t){document.getElementById("back-button").addEventListener("click",t)}getHTML(){return`
                <button id="back-button" class="btn btn-primary" type="button">Назад</button>
            `}render(t){const r=this.getHTML();this.parent.insertAdjacentHTML("beforeend",r),this.addListeners(t)}}class u{constructor(t){this.parent=t,this.alertPlaceholder=document.getElementById("liveAlertPlaceholder"),this.init()}init(){const t=document.getElementById("liveAlertBtn");t&&t.addEventListener("click",()=>{this.alert("Отлично, вы запустили это предупреждающее сообщение!","success")})}alert(t,r){const e=document.createElement("div");e.innerHTML=[`<div class="alert alert-${r} alert-dismissible" role="alert">`,`   <div>${t}</div>`,'   <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Закрыть"></button>',"</div>"].join(""),this.alertPlaceholder?this.alertPlaceholder.append(e):this.parent?this.parent.append(e):console.warn("Alert placeholder not found")}success(t){this.alert(t,"success")}error(t){this.alert(t,"danger")}warning(t){this.alert(t,"warning")}info(t){this.alert(t,"info")}clear(){this.alertPlaceholder&&(this.alertPlaceholder.innerHTML="")}}class p{async get(t,r){try{const e=await fetch(t);await this._handleResponse(e,r)}catch(e){console.error("Network error:",e),r(null,0)}}async post(t,r,e){try{const s=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});await this._handleResponse(s,e)}catch(s){console.error("Network error:",s),e(null,0)}}async patch(t,r,e){try{const s=await fetch(t,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});await this._handleResponse(s,e)}catch(s){console.error("Network error:",s),e(null,0)}}async delete(t,r){try{const e=await fetch(t,{method:"DELETE"});await this._handleResponse(e,r)}catch(e){console.error("Network error:",e),r(null,0)}}async _handleResponse(t,r){try{const e=await t.text();let s=null;if(e)try{s=JSON.parse(e)}catch(n){console.error("Ошибка парсинга JSON:",n)}r(s,t.status)}catch(e){console.error("Response handling error:",e),r(null,t?.status||0)}}}const c=new p;class g{constructor(){this.baseUrl="http://localhost:3000"}getStocks(){return`${this.baseUrl}/stocks`}getStockById(t){return`${this.baseUrl}/stocks/${t}`}createStock(){return`${this.baseUrl}/stocks`}removeStockById(){return`${this.baseUrl}/stocks/${id}`}updateStockById(){return`${this.baseUrl}/stocks/${id}`}}const d=new g;class m{constructor(t,r){this.parent=t,this.id=r,this.alerts=null,this.data=null}getData(){c.get(d.getStocks(),t=>{this.renderData(t)})}getStaticData(){return{1:{title:"Тайская кошка",content:"Элегантная кошка с акромеланическим окрасом (светлое тело с тёмными лапами, мордочкой и хвостом). Умная, общительная и разговорчивая порода. Обладает ярко-голубыми глазами и крепким телосложением."},2:{title:"Персидская кошка",content:"Пушистая аристократка с плоской мордочкой и большими выразительными глазами. Спокойный и ласковый характер. Требует регулярного ухода за длинной густой шерстью."},3:{title:"Шотландская вислоухая",content:"Уникальная порода с загнутыми вперёд ушками и круглыми глазами. Дружелюбная, адаптивная кошка с уравновешенным характером. Бывает как короткошёрстной, так и длинношёрстной."}}[this.id]}renderData(t){const r=t.find(e=>e.id==this.id);r&&new o(this.pageRoot).render(r,this.clickCard.bind(this))}getProductAlertContent(){return this.getStaticData()}get pageRoot(){return document.getElementById("product-page")}getHTML(){return`
            <div id="product-page">
                <div id="liveAlertPlaceholder" style="position: fixed; top: 20px; left: 50%; transform: translateX(-50%); z-index: 1050; max-width: 500px;"></div>
                <div class="container mt-4">
                    <div id="back-button-container" class="mb-3"></div>
                    <div id="product-card-container"></div>
                    <div class="text-center mt-4">
                        <button type="button" class="btn btn-primary" id="liveAlertBtn">Показать информацию о породе</button>
                    </div>
                </div>
            </div>
        `}clickBack(){new l(this.parent).render()}clickCard(){console.log("Card clicked")}setupAlerts(){this.alerts=new u(this.pageRoot);const t=document.getElementById("liveAlertBtn");t&&t.addEventListener("click",()=>{const r=this.getProductAlertContent();if(r){const e=`
                        <h4 class="alert-heading">${r.title}</h4>
                        <hr>
                        <p class="mb-0">${r.content}</p>
                    `;switch({1:"info",2:"warning",3:"success"}[this.id]||"success"){case"info":this.alerts.alert(e,"info");break;case"warning":this.alerts.alert(e,"warning");break;case"success":this.alerts.alert(e,"success");break;default:this.alerts.alert(e,"success")}}else this.alerts.error("Информация о породе не найдена")})}render(){this.parent.innerHTML="";const t=this.getHTML();this.parent.insertAdjacentHTML("beforeend",t),new h(this.pageRoot.querySelector("#back-button-container")).render(this.clickBack.bind(this)),this.getData(),this.setupAlerts()}}class l{constructor(t){this.parent=t}get pageRoot(){return document.getElementById("main-page")}getHTML(){return`
                <header>
                    <h1 align="center">Главная страница</h1>
                </header>
                
                <div id="main-page" class="d-flex flex-wrap gap-3 justify-content-center"><div/> 
            `}getData(){c.get(d.getStocks(),t=>{this.renderData(t)})}clickCard(t){const r=t.target.dataset.id;new m(this.parent,r).render()}renderData(t){t.forEach(r=>{new o(this.pageRoot).render(r,this.clickCard.bind(this))})}render(){this.parent.innerHTML="";const t=this.getHTML();this.parent.insertAdjacentHTML("beforeend",t),this.getData()}}const f=document.getElementById("root"),y=new l(f);y.render();
